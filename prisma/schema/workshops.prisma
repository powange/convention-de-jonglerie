// =============================================================================
// Ateliers â€” Workshops, favoris et lieux
// =============================================================================

model Workshop {
  id              Int      @id @default(autoincrement())
  editionId       Int
  creatorId       Int
  title           String
  description     String?  @db.Text
  startDateTime   DateTime
  endDateTime     DateTime
  maxParticipants Int?
  locationId      Int?
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  edition   Edition            @relation(fields: [editionId], references: [id], onDelete: Cascade)
  creator   User               @relation(fields: [creatorId], references: [id], onDelete: Cascade)
  location  WorkshopLocation?  @relation(fields: [locationId], references: [id], onDelete: SetNull)
  favorites WorkshopFavorite[]

  @@index([editionId])
  @@index([creatorId])
  @@index([startDateTime])
  @@index([locationId])
}

model WorkshopFavorite {
  id         Int      @id @default(autoincrement())
  workshopId Int
  userId     Int
  createdAt  DateTime @default(now())

  workshop Workshop @relation(fields: [workshopId], references: [id], onDelete: Cascade)
  user     User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([workshopId, userId])
  @@index([workshopId])
  @@index([userId])
}

model WorkshopLocation {
  id        Int      @id @default(autoincrement())
  editionId Int
  name      String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  edition   Edition    @relation(fields: [editionId], references: [id], onDelete: Cascade)
  workshops Workshop[]

  @@index([editionId])
}
